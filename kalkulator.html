<!DOCTYPE html>
<html>
<head>
  <title>Kalkulator</title>
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      background-color: #f4f4f4;
      font-family: Arial, sans-serif;
    }

    .kalkulator {
      width: 320px;
      background-color: #ffffff;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }

    .display {
      width: 100%;
      padding: 20px;
      background-color: #222;
      color: #fff;
      text-align: right;
      font-size: 2em;
      border: none;
      box-sizing: border-box;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th, td {
      padding: 0;
    }

    button {
      width: 100%;
      padding: 20px;
      font-size: 1.2em;
      border: 1px solid #ddd;
      background-color: #f9f9f9;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    button:active {
      background-color: #ddd;
    }

    button.operator {
      background-color: #f0ad4e;
      color: white;
    }

    button.operator:hover {
      background-color: #ec971f;
    }

    button.equal {
      background-color: #5cb85c;
      color: white;
    }

    button.equal:hover {
      background-color: #4cae4c;
    }

    button.clear {
      background-color: #d9534f;
      color: white;
    }

    button.clear:hover {
      background-color: #c9302c;
    }
  </style>
  <script>
    let obecnieWpisany = '';
    let wyrazenie = '';
    let wynikWyswietlony = false;

    function dolaczDoWyswietlacza(wartosc) {
      if (wynikWyswietlony) {
        wyrazenie = '';
        wynikWyswietlony = false;
      }
      if (wartosc === '.' && obecnieWpisany.includes('.')) {
        return;
      }
      obecnieWpisany += wartosc;
      wyrazenie += wartosc;
      document.getElementById('display').value = wyrazenie;

      if (document.getElementById('display').scrollWidth > document.getElementById('display').offsetWidth) {
        document.getElementById('display').scrollLeft = document.getElementById('display').scrollWidth;
      }
    }

    function ustawOperator(operator) {
      if (wynikWyswietlony) {
        wynikWyswietlony = false;
      }
      if (obecnieWpisany === '' && wyrazenie.length > 0 && isNaN(wyrazenie[wyrazenie.length - 1])) {
        wyrazenie = wyrazenie.slice(0, -1) + operator;
      } else {
        wyrazenie += operator;
      }
      obecnieWpisany = '';
      document.getElementById('display').value = wyrazenie;
      document.getElementById('display').scrollLeft = document.getElementById('display').scrollWidth;
    }

    function Wynik() {
      if (wyrazenie === '') return;
      try {
        let wynik = obliczWyrazenie(wyrazenie);
        document.getElementById('display').value = wynik;
        wyrazenie = wynik.toString();
        obecnieWpisany = wynik.toString();
        wynikWyswietlony = true;
      } catch (e) {
        document.getElementById('display').value = 'Błąd';
        wyrazenie = '';
        obecnieWpisany = '';
        wynikWyswietlony = false;
      }
    }

    function Wyczysc() {
      obecnieWpisany = '';
      wyrazenie = '';
      document.getElementById('display').value = '';
      wynikWyswietlony = false;
    }

    function obliczWyrazenie(expr) {
      let liczby = [];
      let operatory = [];
      let liczba = '';

      for (let i = 0; i < expr.length; i++) {
        let char = expr[i];
        if (!isNaN(char) || char === '.') {
          liczba += char;
        } else {
          if (liczba !== '') {
            liczby.push(parseFloat(liczba));
            liczba = '';
          }
          while (operatory.length > 0 && priorytet(operatory[operatory.length - 1]) >= priorytet(char)) {
            let op = operatory.pop();
            let b = liczby.pop();
            let a = liczby.pop();
            liczby.push(Operatory(a, op, b));
          }
          operatory.push(char);
        }
      }
      if (liczba !== '') {
        liczby.push(parseFloat(liczba));
      }
      while (operatory.length > 0) {
        let op = operatory.pop();
        let b = liczby.pop();
        let a = liczby.pop();
        liczby.push(Operatory(a, op, b));
      }
      return liczby[0];
    }

    function Operatory(num1, operator, num2) {
      switch (operator) {
        case '+':
          return num1 + num2;
        case '-':
          return num1 - num2;
        case '*':
          return num1 * num2;
        case '/':
          if (num2 === 0) {
            return 'Błąd';
          }
          return num1 / num2;
        case '%':
          if (num2 == 0) {
            return 'Błąd';
          }
          return num1 % num2;
        default:
          return num2;
      }
    }

    function priorytet(op) {
      if (op === '+' || op === '-') {
        return 1;
      }
      if (op === '*' || op === '/' || op === '%') {
        return 2;
      }
      return 0;
    }
  </script>
</head>
<body>
  <div class="kalkulator">
    <input type="text" id="display" class="display" readonly>
    <table>
      <tr>
        <td><button class="klawisz" onclick="dolaczDoWyswietlacza('7')">7</button></td>
        <td><button class="klawisz" onclick="dolaczDoWyswietlacza('8')">8</button></td>
        <td><button class="klawisz" onclick="dolaczDoWyswietlacza('9')">9</button></td>
        <td><button class="klawisz operator" onclick="ustawOperator('/')">/</button></td>
      </tr>
      <tr>
        <td><button class="klawisz" onclick="dolaczDoWyswietlacza('4')">4</button></td>
        <td><button class="klawisz" onclick="dolaczDoWyswietlacza('5')">5</button></td>
        <td><button class="klawisz" onclick="dolaczDoWyswietlacza('6')">6</button></td>
        <td><button class="klawisz operator" onclick="ustawOperator('*')">*</button></td>
      </tr>
      <tr>
        <td><button class="klawisz" onclick="dolaczDoWyswietlacza('1')">1</button></td>
        <td><button class="klawisz" onclick="dolaczDoWyswietlacza('2')">2</button></td>
        <td><button class="klawisz" onclick="dolaczDoWyswietlacza('3')">3</button></td>
        <td><button class="klawisz operator" onclick="ustawOperator('-')">-</button></td>
      </tr>
      <tr>
        <td><button class="klawisz" onclick="dolaczDoWyswietlacza('0')">0</button></td>
        <td><button class="klawisz" onclick="dolaczDoWyswietlacza('.')">.</button></td>
        <td><button class="klawisz operator" onclick="ustawOperator('+')">+</button></td>
        <td><button class="klawisz equal" onclick="Wynik()">=</button></td>
      </tr>
      <tr>
        <td colspan="4"><button class="klawisz clear" onclick="Wyczysc()">C</button></td>
      </tr>
    </table>
  </div>
</body>
</html>
